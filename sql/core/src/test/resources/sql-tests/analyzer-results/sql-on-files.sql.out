-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TABLE TEST_PARQUET USING PARQUET AS SELECT 1
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`TEST_PARQUET`, ErrorIfExists, [1]
   +- Project [1 AS 1#x]
      +- OneRowRelation


-- !query
SELECT * FROM parquet.``
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EMPTY_LOCATION",
  "sqlState" : "42K05",
  "messageParameters" : {
    "location" : ""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 24,
    "fragment" : "parquet.``"
  } ]
}


-- !query
SELECT * FROM parquet.`/file/not/found`
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "PATH_NOT_FOUND",
  "sqlState" : "42K03",
  "messageParameters" : {
    "path" : "file:/file/not/found"
  }
}


-- !query
SELECT * FROM parquet.`${spark.sql.warehouse.dir}/TEST_PARQUET`
-- !query analysis
Project [1#x]
+- Relation [1#x] parquet


-- !query
DROP TABLE TEST_PARQUET
-- !query analysis
DropTable false, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.TEST_PARQUET


-- !query
CREATE TABLE TEST_ORC USING ORC AS SELECT 1
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`TEST_ORC`, ErrorIfExists, [1]
   +- Project [1 AS 1#x]
      +- OneRowRelation


-- !query
SELECT * FROM orc.``
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EMPTY_LOCATION",
  "sqlState" : "42K05",
  "messageParameters" : {
    "location" : ""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 20,
    "fragment" : "orc.``"
  } ]
}


-- !query
SELECT * FROM orc.`/file/not/found`
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "PATH_NOT_FOUND",
  "sqlState" : "42K03",
  "messageParameters" : {
    "path" : "file:/file/not/found"
  }
}


-- !query
SELECT * FROM orc.`${spark.sql.warehouse.dir}/TEST_ORC`
-- !query analysis
Project [1#x]
+- Relation [1#x] orc


-- !query
DROP TABLE TEST_ORC
-- !query analysis
DropTable false, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.TEST_ORC


-- !query
CREATE TABLE TEST_CSV USING CSV AS SELECT 1
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`TEST_CSV`, ErrorIfExists, [1]
   +- Project [1 AS 1#x]
      +- OneRowRelation


-- !query
SELECT * FROM csv.``
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EMPTY_LOCATION",
  "sqlState" : "42K05",
  "messageParameters" : {
    "location" : ""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 20,
    "fragment" : "csv.``"
  } ]
}


-- !query
SELECT * FROM csv.`/file/not/found`
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "PATH_NOT_FOUND",
  "sqlState" : "42K03",
  "messageParameters" : {
    "path" : "file:/file/not/found"
  }
}


-- !query
SELECT * FROM csv.`${spark.sql.warehouse.dir}/TEST_CSV`
-- !query analysis
Project [_c0#x]
+- Relation [_c0#x] csv


-- !query
DROP TABLE TEST_CSV
-- !query analysis
DropTable false, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.TEST_CSV


-- !query
CREATE TABLE TEST_JSON USING JSON AS SELECT 1
-- !query analysis
CreateDataSourceTableAsSelectCommand `spark_catalog`.`default`.`TEST_JSON`, ErrorIfExists, [1]
   +- Project [1 AS 1#x]
      +- OneRowRelation


-- !query
SELECT * FROM json.``
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "INVALID_EMPTY_LOCATION",
  "sqlState" : "42K05",
  "messageParameters" : {
    "location" : ""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 15,
    "stopIndex" : 21,
    "fragment" : "json.``"
  } ]
}


-- !query
SELECT * FROM json.`/file/not/found`
-- !query analysis
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "PATH_NOT_FOUND",
  "sqlState" : "42K03",
  "messageParameters" : {
    "path" : "file:/file/not/found"
  }
}


-- !query
SELECT * FROM json.`${spark.sql.warehouse.dir}/TEST_JSON`
-- !query analysis
Project [1#xL]
+- Relation [1#xL] json


-- !query
DROP TABLE TEST_JSON
-- !query analysis
DropTable false, false
+- ResolvedIdentifier V2SessionCatalog(spark_catalog), default.TEST_JSON
